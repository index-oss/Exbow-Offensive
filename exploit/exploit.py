import json, subprocess

def main():
    with open("ai/ai_output.json") as f:
        j = json.load(f)
    response = j.get("response", "")
    print("LLM response:\n", response, "\n")

    curl_cmds = [line.strip() for line in response.splitlines() if line.strip().startswith("curl ")]

    for i, cmd in enumerate(curl_cmds):
        print(f"[{i+1}] Executing: {cmd}")
        try:
            res = subprocess.run(cmd, shell=True, capture_output=True, text=True, timeout=30)
            print(res.stdout[:200])
        except Exception as e:
            print("Error:", e)

if __name__ == "__main__":
    main()